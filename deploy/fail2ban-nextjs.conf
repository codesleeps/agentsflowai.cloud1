# ===========================================
# Fail2ban Configuration for AgentsFlowAI
# ===========================================
# Copy to: /etc/fail2ban/jail.d/agentsflow-ai.conf
# Restart: sudo systemctl restart fail2ban
# Check status: sudo fail2ban-client status
# ===========================================

# Rate limit violations from Nginx
[nginx-limit-req]
enabled = true
filter = nginx-limit-req
action = iptables-multiport[name=ReqLimit, port="http,https", protocol=tcp]
         sendmail-whois[name=ReqLimit, dest=admin@agentsflowai.cloud]
logpath = /var/log/nginx/agentsflow-ai-error.log
findtime = 600
maxretry = 10
bantime = 7200

# Bad bots and scanners
[nginx-badbots]
enabled = true
filter = nginx-badbots
action = iptables-multiport[name=BadBots, port="http,https"]
logpath = /var/log/nginx/agentsflow-ai-access.log
findtime = 86400
maxretry = 2
bantime = 86400

# HTTP authentication failures
[nginx-http-auth]
enabled = true
filter = nginx-http-auth
action = iptables-multiport[name=HTTPAuth, port="http,https"]
logpath = /var/log/nginx/agentsflow-ai-error.log
findtime = 600
maxretry = 5
bantime = 3600

# Block 404 scanners
[nginx-404]
enabled = true
port = http,https
filter = nginx-404
logpath = /var/log/nginx/agentsflow-ai-access.log
findtime = 600
maxretry = 30
bantime = 3600
